generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Uloga {
  uloga_id  Int        @id @default(autoincrement())
  naziv     String     @db.VarChar(50)
  opis      String?    @db.Text
  korisnici Korisnik[]

  @@map("uloge")
}

model Korisnik {
  korisnik_id     Int               @id @default(autoincrement())
  email           String            @unique @db.VarChar(255)
  password_hash   String            @db.VarChar(255)
  ime             String            @db.VarChar(100)
  datum_kreiranja DateTime          @default(now()) @db.Timestamp(6)
  uloga_id        Int
  uloga           Uloga             @relation(fields: [uloga_id], references: [uloga_id])
  omiljeneStanice OmiljenaStanica[]
  omiljeneLinije  OmiljenaLinija[]

  @@map("korisnici")
}

model Stanica {
  stanica_id      Int               @id @default(autoincrement())
  naziv           String            @db.VarChar(255)
  lat             Float             @db.DoublePrecision
  lng             Float             @db.DoublePrecision
  aktivna         Boolean           @default(true)
  linijeStanice   LinijaStanica[]
  omiljeneStanice OmiljenaStanica[]

  @@map("stanice")
}

model Linija {
  linija_id      Int              @id @default(autoincrement())
  broj           String           @db.VarChar(10)
  tip            String           @db.VarChar(50)
  ime_linije     String           @db.VarChar(255)
  aktivna        Boolean          @default(true)
  linijeStanice  LinijaStanica[]
  omiljeneLinije OmiljenaLinija[]

  @@map("linije")
}

model LinijaStanica {
  linija_id  Int
  stanica_id Int
  linija     Linija  @relation(fields: [linija_id], references: [linija_id], onDelete: Cascade)
  stanica    Stanica @relation(fields: [stanica_id], references: [stanica_id], onDelete: Cascade)

  @@id([linija_id, stanica_id])
  @@map("linija_stanica")
}

model OmiljenaStanica {
  korisnik_id Int
  stanica_id  Int
  korisnik    Korisnik @relation(fields: [korisnik_id], references: [korisnik_id], onDelete: Cascade)
  stanica     Stanica  @relation(fields: [stanica_id], references: [stanica_id], onDelete: Cascade)

  @@id([korisnik_id, stanica_id])
  @@map("omiljene_stanice")
}

model OmiljenaLinija {
  korisnik_id Int
  linija_id   Int
  korisnik    Korisnik @relation(fields: [korisnik_id], references: [korisnik_id], onDelete: Cascade)
  linija      Linija   @relation(fields: [linija_id], references: [linija_id], onDelete: Cascade)

  @@id([korisnik_id, linija_id])
  @@map("omiljene_linije")
}